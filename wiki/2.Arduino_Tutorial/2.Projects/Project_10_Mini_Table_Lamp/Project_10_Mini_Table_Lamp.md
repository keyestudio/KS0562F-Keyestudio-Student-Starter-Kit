# Project 10：Mini Table Lamp

![Img](/media/img-20230214114203.png)

## 10.1. Introduction：                                                                   
I/O ports mean the input and output ports. In this project, we will seek to use the INPUT function to read the output value of the device connected to it.

Next, we'll use a button and a LED for input and output to give you a better understanding of the I/O function.
            
## 10.2. Components Needed：                                                                   
- 328 PLUS Control Board×1
- Button×1 
- Red LED×1
- 220Ω Resistor×1
- 10KΩ Resistor×1
- Breadboard×1
- Jumper Wire×7
- USB Cable×1
- Multimeter×1
- 100NF-104-Ceramic Capacitor×1

## 10.3. Component Knowledge：
                                                                                                                            
![Img](/media/img-20230214114544.png)

**Button：** A button can be used to control the circuit on and off, when it is plugged into a circuit and not pressed, the circuit will be disconnected. The circuit works when you press the button, but breaks again when you release it. 

Why does it only work when you press it? It starts from the internal structure of the button, which don’t allow current to travel from one end of the button to the other before it is pressed. When pressed, a metal strip inside the button connects the two sides to allow electricity to pass through.

Internal Structure of the Button：![Img](/media/img-20230214120055.png)，before the button is pressed, 1 , 2 , 3 and 4 are on, but 1, 3 or 1, 4 or 2, 3 or 2, 4 are off (Only when the button is pressed, they will be on).

The button switch is one of the most commonly used components in circuit design.


**Schematic Diagram of the Button:**

![Img](/media/img-20230214120033.png)

![Img](/media/img-20230214120038.png)

**What is Button Jitter？**
We think of the switch circuit as "press the button and turn it on immediately", press it again and turn it off immediately". In fact, this is not the case.

The button usually uses a mechanical elastic switch, and the mechanical elastic switch will produce a series of shake due to the elastic action at the moment when the mechanical contact is opened and closed (usually about 10ms). As a result, the button switch will not immediately and stably turn on the circuit when it is closed, and it will not be completely and instantaneously disconnected when it is turned off. 

![Img](/media/img-20230214120131.png)

**How to Eliminate the Jitter?？**
There are two common methods to remove jitter: software method and hardware method. We only discuss the fomer.

We already know that the shake time generated by elasticity is about 10ms, and the delay command can be used to delay the execution time of the command to achieve the effect of shake removal.

Thus, we delay 0.02s in the code to achieve the anti-shake function of a button.

![Img](/media/img-20230214120144.png)

Hardware method: Key jitter can be eliminated using 100NF-104-ceramic capacitors or 10NF-103-ceramic capacitors. In this project, we connected the 100NF-104-ceramic capacitor in parallel at both ends of the resistor, taking advantage of the delay characteristic of the capacitor's discharge. The level of jitter is absorbed by the capacitor so as to eliminate the jitter.

**Electrolytic Capacitor：** It is a positive and negative electrode, the ordinary capacitor is not polar, but the electrolytic capacitor is positive and negative points, the access circuit will be damaged, must not be reversed.

An electrolytic capacitor with two pins is taken as an example：

![Img](/media/img-20230323153837.png)

The method of identifying the positive and negative electrode of the electrolytic capacitor is as follows：

①The negative extremes are identified by looking at the "-" symbol marked outside or by a ribbon.

![Img](/media/img-20230323155447.png)

②The length of the two pins is different to judge, the long pin is positive pole, short pin is negative pole.

![Img](/media/img-20230323154409.png)

## 10.4. Wiring Diagram 1：                                                                    

**Schematic Diagram：**

![Img](/media/img-20230323145559.png)

**Wiring Diagram：**

![Img](/media/img-20230323145628.jpg)

## 10.5. Test Code：                                                                    

```c
//**********************************************************************************
int buttonPin = 7;             //Connect button to digital pin 7
int ledPin = 11;               //Connect LED to digital pin 11
int ledState = LOW;            // ledState records the state of LED
int buttonState;               // buttonState records the state of button
int lastButtonState = LOW;     // lastbuttonState records the last state of button
long lastDebounceTime = 0;
long debounceDelay = 50;       //Remove jitter time

void setup() {
  pinMode(buttonPin, INPUT);
  pinMode(ledPin, OUTPUT);
  digitalWrite(ledPin, ledState);
}

void loop() {   
  int reading = digitalRead(buttonPin);  //reading records the data of buttonPin

  // Record the present time as soon as a change in data is detected.
  if (reading != lastButtonState) {
      lastDebounceTime= millis();
  }

// Wait for 50ms, check again whether the button state is the same as that of the current button. If it is not, change the button state. Yet if the button is at high(being pressed), change the led state.
  if ((millis() - lastDebounceTime) >debounceDelay) {
    if (reading != buttonState) {
      buttonState = reading;
      if (buttonState == HIGH) {
          ledState= !ledState;
      }
    }
  }

  digitalWrite(ledPin, ledState);

  // Change the last state value of button
  lastButtonState = reading;
}
//**********************************************************************************
```

## 10.6. Test Result 1：                                                                      
After uploading the code successfully, wrie according to the wiring diagram and power up, then press the button, LED turns on，press it again, it turns off. Doesn't it look like a mini table lamp?

## 10.7. Wiring Diagram and Test Result 2：

![Img](/media/img-20230322110907.png)

Press the button, the voltage at both ends of the resistor measured by the multimeter is 4.92V (about 5V). At this time, the voltage of IO port D7 is about 0V, which is in the low level state.

![Img](/media/img-20230322111743.png)

Relese it, the voltage is 0V, and the voltage of IO port D7 is about 5V, which is in the high level state.